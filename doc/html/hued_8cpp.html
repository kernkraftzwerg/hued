<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hued: /home/as/Daten/src/hued/src/hued.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hued
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('hued_8cpp.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">hued.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;boost/asio.hpp&gt;</code><br />
<code>#include &lt;boost/bind.hpp&gt;</code><br />
<code>#include &lt;boost/date_time/posix_time/posix_time.hpp&gt;</code><br />
<code>#include &lt;boost/property_tree/ptree.hpp&gt;</code><br />
<code>#include &lt;boost/property_tree/xml_parser.hpp&gt;</code><br />
<code>#include &lt;boost/lexical_cast.hpp&gt;</code><br />
<code>#include &lt;boost/format.hpp&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
<code>#include &lt;unordered_set&gt;</code><br />
<code>#include &lt;regex&gt;</code><br />
</div>
<p><a href="hued_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResponder.html">Responder</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SSDP responder class.  <a href="classResponder.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classListener.html">Listener</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SSDP <a class="el" href="classListener.html" title="SSDP Listener.">Listener</a>.  <a href="classListener.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top"><a id="a0ddf1224851353fc92bfbff6f499fa97"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hued_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Daemon entry point, one program argument in the form "server:service" is required. <br /></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a32dcefdb3c59c7ee41853ea6a7931f0f"><td class="memItemLeft" align="right" valign="top"><a id="a32dcefdb3c59c7ee41853ea6a7931f0f"></a>
const uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hued_8cpp.html#a32dcefdb3c59c7ee41853ea6a7931f0f">multicast_port</a> =1900</td></tr>
<tr class="memdesc:a32dcefdb3c59c7ee41853ea6a7931f0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Listen on this port for SSDP requests. <br /></td></tr>
<tr class="separator:a32dcefdb3c59c7ee41853ea6a7931f0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab92c95d1ca95009b1393987f79270309"><td class="memItemLeft" align="right" valign="top"><a id="ab92c95d1ca95009b1393987f79270309"></a>
const uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hued_8cpp.html#ab92c95d1ca95009b1393987f79270309">t_refresh</a> =300</td></tr>
<tr class="memdesc:ab92c95d1ca95009b1393987f79270309"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cache the description.xml for this many seconds. <br /></td></tr>
<tr class="separator:ab92c95d1ca95009b1393987f79270309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11cee0097b4a3c25750c315b56a2e4f4"><td class="memItemLeft" align="right" valign="top">const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hued_8cpp.html#a11cee0097b4a3c25750c315b56a2e4f4">HUE_RESPONSE</a> []</td></tr>
<tr class="memdesc:a11cee0097b4a3c25750c315b56a2e4f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">All three responses to an SSDP request start with this data.  <a href="hued_8cpp.html#a11cee0097b4a3c25750c315b56a2e4f4">More...</a><br /></td></tr>
<tr class="separator:a11cee0097b4a3c25750c315b56a2e4f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad823e8770f260c9a906585dee1b93060"><td class="memItemLeft" align="right" valign="top">const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hued_8cpp.html#ad823e8770f260c9a906585dee1b93060">HUE_ST1</a> []</td></tr>
<tr class="memdesc:ad823e8770f260c9a906585dee1b93060"><td class="mdescLeft">&#160;</td><td class="mdescRight">The first SSDP response is HUE_RESONSE+HUE_ST1.  <a href="hued_8cpp.html#ad823e8770f260c9a906585dee1b93060">More...</a><br /></td></tr>
<tr class="separator:ad823e8770f260c9a906585dee1b93060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab504bd0d70c272cb77b9034372b3fff4"><td class="memItemLeft" align="right" valign="top">const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hued_8cpp.html#ab504bd0d70c272cb77b9034372b3fff4">HUE_ST2</a> []</td></tr>
<tr class="memdesc:ab504bd0d70c272cb77b9034372b3fff4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The second SSDP response is HUE_RESONSE+HUE_ST2.  <a href="hued_8cpp.html#ab504bd0d70c272cb77b9034372b3fff4">More...</a><br /></td></tr>
<tr class="separator:ab504bd0d70c272cb77b9034372b3fff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6164503c6a4926f568699b7074be7487"><td class="memItemLeft" align="right" valign="top">const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hued_8cpp.html#a6164503c6a4926f568699b7074be7487">HUE_ST3</a> []</td></tr>
<tr class="memdesc:a6164503c6a4926f568699b7074be7487"><td class="mdescLeft">&#160;</td><td class="mdescRight">The third SSDP response is HUE_RESONSE+HUE_ST3.  <a href="hued_8cpp.html#a6164503c6a4926f568699b7074be7487">More...</a><br /></td></tr>
<tr class="separator:a6164503c6a4926f568699b7074be7487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa036b969dbcbf0263735dbcd447b430a"><td class="memItemLeft" align="right" valign="top">const std::unordered_set&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hued_8cpp.html#aa036b969dbcbf0263735dbcd447b430a">service_types</a></td></tr>
<tr class="memdesc:aa036b969dbcbf0263735dbcd447b430a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A list of service types to which hued responds. Those types can be found in the "ST:" field of the SSDP request.  <a href="hued_8cpp.html#aa036b969dbcbf0263735dbcd447b430a">More...</a><br /></td></tr>
<tr class="separator:aa036b969dbcbf0263735dbcd447b430a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>HUE SSDP responder daemon</p>
<p>This little daemon does the SSDP handling of a Philips hue bridge or a hue bridge emulation like HA-Bridge or node-red-contrib-amazon-echo. SSDP can not detect devices in other subnets or in docker containers because the used multicast UDP datagrams do not pass gateways or the docker network bridge. If this daemon runs in the same subnet as the SSDP enumerator (e.g. an Amazon Echo) then it will respond to the SSDP requests and redirect the enumerator to the HUE bridge (emulator). The communication to the HUE bridge is simple unicast HTTP, so the HUE bridge can be elsewhere, in a docker container or around the world.</p>
<p>The daemon requires one parameter in the form "server:service", e.g. "my-hue.local:80".</p>
<dl class="section author"><dt>Author</dt><dd>Andreas Schmitt </dd></dl>

<p class="definition">Definition in file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>
</div><h2 class="groupheader">Variable Documentation</h2>
<a id="a11cee0097b4a3c25750c315b56a2e4f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11cee0097b4a3c25750c315b56a2e4f4">&#9670;&nbsp;</a></span>HUE_RESPONSE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char HUE_RESPONSE[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">  <span class="stringliteral">&quot;HTTP/1.1 200 OK\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;HOST: 239.255.255.250:1900\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;CACHE-CONTROL: max-age=100\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;EXT:\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;LOCATION: http://%1%:%2%/description.xml\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;SERVER: Linux/3.14.0 UPnP/1.0 IpBridge/1.24.0\r\n&quot;</span>  </div>
<div class="line">  <span class="stringliteral">&quot;hue-bridgeid: %3%\r\n%4%&quot;</span></div>
</div><!-- fragment -->
<p>All three responses to an SSDP request start with this data. </p>

<p class="definition">Definition at line <a class="el" href="hued_8cpp_source.html#l00068">68</a> of file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="hued_8cpp_source.html#l00245">Responder::respond()</a>.</p>

</div>
</div>
<a id="ad823e8770f260c9a906585dee1b93060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad823e8770f260c9a906585dee1b93060">&#9670;&nbsp;</a></span>HUE_ST1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char HUE_ST1[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">  <span class="stringliteral">&quot;ST: upnp:rootdevice\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;USN: uuid:%1%::upnp:rootdevice\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;\r\n&quot;</span></div>
</div><!-- fragment -->
<p>The first SSDP response is HUE_RESONSE+HUE_ST1. </p>

<p class="definition">Definition at line <a class="el" href="hued_8cpp_source.html#l00077">77</a> of file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="hued_8cpp_source.html#l00245">Responder::respond()</a>.</p>

</div>
</div>
<a id="ab504bd0d70c272cb77b9034372b3fff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab504bd0d70c272cb77b9034372b3fff4">&#9670;&nbsp;</a></span>HUE_ST2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char HUE_ST2[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">  <span class="stringliteral">&quot;ST: uuid:%1%\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;USN: uuid:%1%\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;\r\n&quot;</span></div>
</div><!-- fragment -->
<p>The second SSDP response is HUE_RESONSE+HUE_ST2. </p>

<p class="definition">Definition at line <a class="el" href="hued_8cpp_source.html#l00082">82</a> of file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="hued_8cpp_source.html#l00245">Responder::respond()</a>.</p>

</div>
</div>
<a id="a6164503c6a4926f568699b7074be7487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6164503c6a4926f568699b7074be7487">&#9670;&nbsp;</a></span>HUE_ST3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char HUE_ST3[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">  <span class="stringliteral">&quot;ST: urn:schemas-upnp-org:device:basic:1\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;USN: uuid:%1%\r\n&quot;</span></div>
<div class="line">  <span class="stringliteral">&quot;\r\n&quot;</span></div>
</div><!-- fragment -->
<p>The third SSDP response is HUE_RESONSE+HUE_ST3. </p>

<p class="definition">Definition at line <a class="el" href="hued_8cpp_source.html#l00087">87</a> of file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="hued_8cpp_source.html#l00245">Responder::respond()</a>.</p>

</div>
</div>
<a id="aa036b969dbcbf0263735dbcd447b430a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa036b969dbcbf0263735dbcd447b430a">&#9670;&nbsp;</a></span>service_types</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::unordered_set&lt;std::string&gt; service_types</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;urn:schemas-upnp-org:device:Basic:1&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;upnp:rootdevice&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;ssdpsearch:all&quot;</span>,</div>
<div class="line">    <span class="stringliteral">&quot;ssdp:all&quot;</span></div>
<div class="line">}</div>
</div><!-- fragment -->
<p>A list of service types to which hued responds. Those types can be found in the "ST:" field of the SSDP request. </p>

<p class="definition">Definition at line <a class="el" href="hued_8cpp_source.html#l00093">93</a> of file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="hued_8cpp_source.html#l00313">Listener::receive()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="hued_8cpp.html">hued.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
