<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hued: Responder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hued
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classResponder.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classResponder-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Responder Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>SSDP responder class.  
 <a href="classResponder.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2efe5939cf74d69404e360cae5c31591"><td class="memItemLeft" align="right" valign="top"><a id="a2efe5939cf74d69404e360cae5c31591"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResponder.html#a2efe5939cf74d69404e360cae5c31591">Responder</a> (io_service &amp;io_service, const std::string &amp;server, const std::string &amp;service)</td></tr>
<tr class="memdesc:a2efe5939cf74d69404e360cae5c31591"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor opens the UDP response port. <br /></td></tr>
<tr class="separator:a2efe5939cf74d69404e360cae5c31591"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22c56df0bc2f7bb3c41fe4475940ab99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResponder.html#a22c56df0bc2f7bb3c41fe4475940ab99">update</a> ()</td></tr>
<tr class="memdesc:a22c56df0bc2f7bb3c41fe4475940ab99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the UUID of the HUE bridge.  <a href="classResponder.html#a22c56df0bc2f7bb3c41fe4475940ab99">More...</a><br /></td></tr>
<tr class="separator:a22c56df0bc2f7bb3c41fe4475940ab99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a313529fc4eb557fe6d5f21fdaf1bcf36"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResponder.html#a313529fc4eb557fe6d5f21fdaf1bcf36">operator()</a> (ip::address addr, uint16_t port, uint16_t mx)</td></tr>
<tr class="memdesc:a313529fc4eb557fe6d5f21fdaf1bcf36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts the SSID response.  <a href="classResponder.html#a313529fc4eb557fe6d5f21fdaf1bcf36">More...</a><br /></td></tr>
<tr class="separator:a313529fc4eb557fe6d5f21fdaf1bcf36"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a83adacd73a94d166a7c4eeb0d9ee2938"><td class="memItemLeft" align="right" valign="top"><a id="a83adacd73a94d166a7c4eeb0d9ee2938"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResponder.html#a83adacd73a94d166a7c4eeb0d9ee2938">refresh</a> (const boost::system::error_code &amp;e)</td></tr>
<tr class="memdesc:a83adacd73a94d166a7c4eeb0d9ee2938"><td class="mdescLeft">&#160;</td><td class="mdescRight">Small helper to set the _refresh flag after the timeout t_refresh. <br /></td></tr>
<tr class="separator:a83adacd73a94d166a7c4eeb0d9ee2938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44436d9f0f8fbb47de7db0281c4bfabf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classResponder.html#a44436d9f0f8fbb47de7db0281c4bfabf">respond</a> (const boost::system::error_code &amp;e, ip::address addr, uint16_t port)</td></tr>
<tr class="memdesc:a44436d9f0f8fbb47de7db0281c4bfabf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends three response telegrams (see <a class="el" href="hued_8cpp.html#a11cee0097b4a3c25750c315b56a2e4f4" title="All three responses to an SSDP request start with this data.">HUE_RESPONSE</a>, <a class="el" href="hued_8cpp.html#ad823e8770f260c9a906585dee1b93060" title="The first SSDP response is HUE_RESONSE+HUE_ST1.">HUE_ST1</a>, <a class="el" href="hued_8cpp.html#ab504bd0d70c272cb77b9034372b3fff4" title="The second SSDP response is HUE_RESONSE+HUE_ST2.">HUE_ST2</a>, <a class="el" href="hued_8cpp.html#a6164503c6a4926f568699b7074be7487" title="The third SSDP response is HUE_RESONSE+HUE_ST3.">HUE_ST3</a>) to the endpoint given by addr and port.  <a href="classResponder.html#a44436d9f0f8fbb47de7db0281c4bfabf">More...</a><br /></td></tr>
<tr class="separator:a44436d9f0f8fbb47de7db0281c4bfabf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:afd5d5c474571f7a3d5fb0c3d92c833cc"><td class="memItemLeft" align="right" valign="top"><a id="afd5d5c474571f7a3d5fb0c3d92c833cc"></a>
io_service &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>_io_service</b></td></tr>
<tr class="separator:afd5d5c474571f7a3d5fb0c3d92c833cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24abe4ca1228fc24ce07dba4bee7d673"><td class="memItemLeft" align="right" valign="top"><a id="a24abe4ca1228fc24ce07dba4bee7d673"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>_server</b></td></tr>
<tr class="separator:a24abe4ca1228fc24ce07dba4bee7d673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6c0fe0a88117b6cdcb9ec373306feb8"><td class="memItemLeft" align="right" valign="top"><a id="ae6c0fe0a88117b6cdcb9ec373306feb8"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>_service</b></td></tr>
<tr class="separator:ae6c0fe0a88117b6cdcb9ec373306feb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a110d9800eaeba4a2663731252b35bb42"><td class="memItemLeft" align="right" valign="top"><a id="a110d9800eaeba4a2663731252b35bb42"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>_uuid</b></td></tr>
<tr class="separator:a110d9800eaeba4a2663731252b35bb42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a056d2c8386d7786771aca34307356394"><td class="memItemLeft" align="right" valign="top"><a id="a056d2c8386d7786771aca34307356394"></a>
ip::udp::socket&#160;</td><td class="memItemRight" valign="bottom"><b>_socket</b></td></tr>
<tr class="separator:a056d2c8386d7786771aca34307356394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab639f73eb10e211b144b67e758c5615b"><td class="memItemLeft" align="right" valign="top"><a id="ab639f73eb10e211b144b67e758c5615b"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>_refresh</b></td></tr>
<tr class="separator:ab639f73eb10e211b144b67e758c5615b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af17221fd5799fe386aed80c1ab96f996"><td class="memItemLeft" align="right" valign="top"><a id="af17221fd5799fe386aed80c1ab96f996"></a>
deadline_timer&#160;</td><td class="memItemRight" valign="bottom"><b>_trefresh</b></td></tr>
<tr class="separator:af17221fd5799fe386aed80c1ab96f996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3e01a5d3d003141680059be7bf007a8"><td class="memItemLeft" align="right" valign="top"><a id="ae3e01a5d3d003141680059be7bf007a8"></a>
deadline_timer&#160;</td><td class="memItemRight" valign="bottom"><b>_tresponse</b></td></tr>
<tr class="separator:ae3e01a5d3d003141680059be7bf007a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SSDP responder class. </p>

<p class="definition">Definition at line <a class="el" href="hued_8cpp_source.html#l00101">101</a> of file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a313529fc4eb557fe6d5f21fdaf1bcf36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a313529fc4eb557fe6d5f21fdaf1bcf36">&#9670;&nbsp;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Responder::operator() </td>
          <td>(</td>
          <td class="paramtype">ip::address&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>mx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Starts the SSID response. </p>
<p>The function calls <a class="el" href="classResponder.html#a22c56df0bc2f7bb3c41fe4475940ab99" title="Update the UUID of the HUE bridge.">update()</a> to get the current UUDI of the HUE bridge. Then it starts an async timer of between 0 and a (pseudo) random time given by mx (in seconds), which triggers <a class="el" href="classResponder.html#a44436d9f0f8fbb47de7db0281c4bfabf" title="Sends three response telegrams (see HUE_RESPONSE, HUE_ST1, HUE_ST2, HUE_ST3) to the endpoint given by...">respond()</a>. This mechanism reduces the DDOS problem for the enumerating device when each enumerated device in the subnet answers to the same request.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>The address to respond to (HUE bridge) </td></tr>
    <tr><td class="paramname">port</td><td>The port to respond to (HUE bridge) </td></tr>
    <tr><td class="paramname">mx</td><td>An interval in seconds, in which the response should be sent. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="hued_8cpp_source.html#l00218">218</a> of file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>

<p class="reference">References <a class="el" href="hued_8cpp_source.html#l00245">respond()</a>.</p>

</div>
</div>
<a id="a44436d9f0f8fbb47de7db0281c4bfabf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44436d9f0f8fbb47de7db0281c4bfabf">&#9670;&nbsp;</a></span>respond()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Responder::respond </td>
          <td>(</td>
          <td class="paramtype">const boost::system::error_code &amp;&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ip::address&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sends three response telegrams (see <a class="el" href="hued_8cpp.html#a11cee0097b4a3c25750c315b56a2e4f4" title="All three responses to an SSDP request start with this data.">HUE_RESPONSE</a>, <a class="el" href="hued_8cpp.html#ad823e8770f260c9a906585dee1b93060" title="The first SSDP response is HUE_RESONSE+HUE_ST1.">HUE_ST1</a>, <a class="el" href="hued_8cpp.html#ab504bd0d70c272cb77b9034372b3fff4" title="The second SSDP response is HUE_RESONSE+HUE_ST2.">HUE_ST2</a>, <a class="el" href="hued_8cpp.html#a6164503c6a4926f568699b7074be7487" title="The third SSDP response is HUE_RESONSE+HUE_ST3.">HUE_ST3</a>) to the endpoint given by addr and port. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>If this async timer error code says something other than OK the fuction returns immediately. </td></tr>
    <tr><td class="paramname">addr</td><td>The address of the SSDP enumerator </td></tr>
    <tr><td class="paramname">port</td><td>The port of the SSDP enumerator </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="hued_8cpp_source.html#l00245">245</a> of file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>

<p class="reference">References <a class="el" href="hued_8cpp_source.html#l00068">HUE_RESPONSE</a>, <a class="el" href="hued_8cpp_source.html#l00077">HUE_ST1</a>, <a class="el" href="hued_8cpp_source.html#l00082">HUE_ST2</a>, and <a class="el" href="hued_8cpp_source.html#l00087">HUE_ST3</a>.</p>

<p class="reference">Referenced by <a class="el" href="hued_8cpp_source.html#l00218">operator()()</a>.</p>

</div>
</div>
<a id="a22c56df0bc2f7bb3c41fe4475940ab99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22c56df0bc2f7bb3c41fe4475940ab99">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Responder::update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the UUID of the HUE bridge. </p>
<p>For obtaining the UUID of the HUE bridge this function downloads the description.xml from the bridge, parses this document and reads the UUID. The function immediately returns if it is called during t_refresh seconds after the last call to prevent DOS to the HUE bridge. </p>

<p class="definition">Definition at line <a class="el" href="hued_8cpp_source.html#l00129">129</a> of file <a class="el" href="hued_8cpp_source.html">hued.cpp</a>.</p>

<p class="reference">References <a class="el" href="hued_8cpp_source.html#l00230">refresh()</a>, and <a class="el" href="hued_8cpp_source.html#l00065">t_refresh</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/as/Daten/src/hued/src/<a class="el" href="hued_8cpp_source.html">hued.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classResponder.html">Responder</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
